<%- include('partials/head') %>

    <!-- Hero Section -->
    <section class="hero hero-page">
        <div class="hero-overlay"></div>
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title fade-in"><%= t.events.page_title || 'Événements & Actualités' %></h1>
                <p class="hero-subtitle fade-in"><%= t.events.page_subtitle || 'Découvrez nos prochains événements et les dernières actualités' %></p>
            </div>
        </div>
    </section>

    <!-- Événements à venir Section -->
    <section class="section events-page-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-calendar-alt"></i> <%= t.events.upcoming_events || 'Événements à venir' %></h2>
                <p class="section-subtitle"><%= t.events.upcoming_events_desc || 'Conférences, cérémonies et événements spéciaux' %></p>
            </div>

            <% if (upcomingEvents.length > 0) { %>
                <div class="events-grid" id="upcomingEventsGrid">
                    <% upcomingEvents.forEach((event, index) => { %>
                        <article class="event-card <%= index >= 3 ? 'hidden-event' : '' %>">
                            <div class="event-card-image">
                                <img src="<%= event.images && event.images.length > 0 ? event.images[0] : '/images/Logo_CIMG_VF_GT_MOSAIQUE.png' %>" alt="<%= event.title %>">
                                <div class="event-card-category"><%= event.category %></div>
                            </div>
                            <div class="event-card-content">
                                <div class="event-card-date">
                                    <i class="far fa-calendar"></i>
                                    <%= new Date(event.date).toLocaleDateString(currentLang === 'tr' ? 'tr-TR' : 'fr-FR', { 
                                        weekday: 'long', 
                                        year: 'numeric', 
                                        month: 'long', 
                                        day: 'numeric' 
                                    }) %>
                                </div>
                                <h3 class="event-card-title"><%= event.title %></h3>
                                <div class="event-card-meta">
                                    <span><i class="far fa-clock"></i> <%= event.start_time %> - <%= event.end_time %></span>
                                    <span><i class="fas fa-map-marker-alt"></i> <%= event.location %></span>
                                </div>
                                <p class="event-card-description"><%= event.description %></p>
                                <button class="btn btn-primary event-details-btn" data-event-id="<%= event.id %>">
                                    <%= t.events.see_details || 'Voir les détails' %>
                                </button>
                            </div>
                        </article>
                    <% }); %>
                </div>
                <% if (upcomingEvents.length > 3) { %>
                    <div class="text-center mt-4">
                        <button class="btn btn-primary" id="loadMoreUpcoming">Afficher plus d'événements</button>
                    </div>
                <% } %>
            <% } else { %>
                <div class="no-events">
                    <i class="far fa-calendar-times"></i>
                    <p><%= t.events.no_events || 'Aucun événement à venir pour le moment' %></p>
                </div>
            <% } %>
        </div>
    </section>

    <!-- Actualités Section -->
    <section class="section activities-page-section" id="actualites">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-newspaper"></i> Actualités</h2>
                <p class="section-subtitle">Les dernières nouvelles de la mosquée</p>
            </div>

            <% if (news.length > 0) { %>
                <div class="events-grid" id="newsGrid">
                    <% news.forEach((article, index) => { %>
                        <article class="event-card <%= index >= 3 ? 'hidden-event' : '' %>">
                            <div class="event-card-image">
                                <% 
                                    let newsImage = '/images/Logo_CIMG_VF_GT_MOSAIQUE.png';
                                    if (article.images && article.images.length > 0) {
                                        newsImage = article.images[0];
                                    } else if (article.image) {
                                        newsImage = article.image;
                                    }
                                %>
                                <img src="<%= newsImage %>" alt="<%= article.title %>">
                                <div class="event-card-category"><%= article.category %></div>
                            </div>
                            <div class="event-card-content">
                                <div class="event-card-date">
                                    <i class="far fa-calendar"></i>
                                    <%= new Date(article.createdAt).toLocaleDateString(currentLang === 'tr' ? 'tr-TR' : 'fr-FR', { 
                                        year: 'numeric', 
                                        month: 'long', 
                                        day: 'numeric' 
                                    }) %>
                                </div>
                                <h3 class="event-card-title"><%= article.title %></h3>
                                <p class="event-card-description"><%= article.content ? article.content.substring(0, 150) : '' %>...</p>
                                <button class="btn btn-primary news-details-btn" data-news-id="<%= article.id %>">
                                    Lire la suite
                                </button>
                            </div>
                        </article>
                    <% }); %>
                </div>
                <% if (news.length > 3) { %>
                    <div class="text-center mt-4">
                        <button class="btn btn-primary" id="loadMoreNews">Afficher plus d'actualités</button>
                    </div>
                <% } %>
            <% } else { %>
                <div class="no-events">
                    <i class="far fa-newspaper"></i>
                    <p>Aucune actualité pour le moment</p>
                </div>
            <% } %>
        </div>
    </section>

    <!-- Événements passés Section -->
    <% if (pastEvents.length > 0) { %>
    <section class="section events-page-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title"><i class="fas fa-calendar-alt"></i> Événements passés</h2>
                <p class="section-subtitle">Retour sur nos événements récents</p>
            </div>

            <div class="events-grid" id="pastEventsGrid">
                <% pastEvents.forEach((event, index) => { %>
                    <article class="event-card past-event <%= index >= 3 ? 'hidden-event' : '' %>" data-past-index="<%= index %>">
                        <div class="event-card-image">
                            <img src="<%= event.images && event.images.length > 0 ? event.images[0] : '/images/Logo_CIMG_VF_GT_MOSAIQUE.png' %>" alt="<%= event.title %>">
                            <div class="event-card-category past-event-category"><%= event.category %></div>
                        </div>
                        <div class="event-card-content">
                            <div class="event-card-date">
                                <i class="far fa-calendar"></i>
                                <%= new Date(event.date).toLocaleDateString(currentLang === 'tr' ? 'tr-TR' : 'fr-FR', { 
                                    weekday: 'long', 
                                    year: 'numeric', 
                                    month: 'long', 
                                    day: 'numeric' 
                                }) %>
                            </div>
                            <h3 class="event-card-title"><%= event.title %></h3>
                            <div class="event-card-meta">
                                <span><i class="far fa-clock"></i> <%= event.start_time %> - <%= event.end_time %></span>
                                <span><i class="fas fa-map-marker-alt"></i> <%= event.location %></span>
                            </div>
                            <p class="event-card-description"><%= event.description %></p>
                            <button class="btn btn-primary event-details-btn" data-event-id="<%= event.id %>">
                                <%= t.events.see_details || 'Voir les détails' %>
                            </button>
                        </div>
                    </article>
                <% }); %>
            </div>
            <% if (pastEvents.length > 3) { %>
                <div class="text-center mt-4">
                    <button class="btn btn-primary" id="loadMorePast">Afficher plus d'événements passés</button>
                </div>
            <% } %>
        </div>
    </section>
    <% } %>

    <%- include('partials/footer') %>
    <%- include('partials/foot') %>

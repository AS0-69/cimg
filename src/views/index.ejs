<%- include('partials/head.ejs') %>

<!-- Hero Section -->
<section class="hero">
    <div class="hero-overlay"></div>
    <div class="hero-content">
        <div class="container">
            <h1 class="hero-title">Bienvenue à la Mosquée Bleue</h1>
            <p class="hero-subtitle">
                Confédération islamique Millî Görüş de Villefranche-sur-Saône
            </p>
            <p class="hero-description">
                Ensemble pour un avenir solidaire. Soutenez votre mosquée et participez au développement de notre communauté.
            </p>
            <div class="hero-buttons">
                <a href="/don" class="btn btn-primary btn-lg">
                    <i class="fas fa-heart"></i>
                    Faire un don
                </a>
                <a href="/contact" class="btn btn-outline btn-lg">
                    <i class="fas fa-envelope"></i>
                    Nous contacter
                </a>
            </div>
        </div>
    </div>
</section>

<!-- Carrousel Citations Coran/Hadith -->
<section class="quotes-carousel-section">
    <div class="container">
        <div class="quotes-carousel">
            <% if (quotes && quotes.length > 0) { %>
                <% quotes.forEach((quote, index) => { %>
                    <div class="quote-slide <%= index === 0 ? 'active' : '' %>">
                        <div class="quote-icon">
                            <i class="fas fa-quote-right"></i>
                        </div>
                        <p class="quote-text">
                            <%= quote.text_original %><br>
                            <em><%= quote.text_fr %></em>
                        </p>
                        <p class="quote-source"><%= quote.author %></p>
                    </div>
                <% }); %>
            <% } else { %>
                <!-- Citation par défaut si aucune active -->
                <div class="quote-slide active">
                    <div class="quote-icon">
                        <i class="fas fa-quote-right"></i>
                    </div>
                    <p class="quote-text">
                        "إِنَّ اللَّهَ مَعَ الصَّابِرِينَ"<br>
                        <em>Certes, Allah est avec les endurants</em>
                    </p>
                    <p class="quote-source">Coran 2:153</p>
                </div>
            <% } %>
        </div>
        <% if (quotes && quotes.length > 1) { %>
            <div class="carousel-dots">
                <% quotes.forEach((quote, index) => { %>
                    <span class="dot <%= index === 0 ? 'active' : '' %>" data-slide="<%= index %>"></span>
                <% }); %>
            </div>
        <% } %>
    </div>
</section>

<!-- Section Présentation & Pôles -->
<section class="presentation-poles-section compact">
    <div class="container-wide">
        <div class="two-column-layout">
            <!-- Colonne Présentation -->
            <div class="column">
                <div class="presentation-content">
                    <h2>À propos de notre mosquée</h2>
                    <p class="lead">
                        La Mosquée Bleue de Villefranche-sur-Saône est un lieu de culte, d'apprentissage et de partage au service de toute la communauté musulmane.
                    </p>
                    
                    <!-- Carousel d'images de la mosquée -->
                    <div class="mosque-images-carousel">
                        <div class="carousel-container">
                            <div class="carousel-slide active">
                                <img src="/images/mosquee_interieur.jpg" alt="Intérieur de la mosquée">
                            </div>
                            <div class="carousel-slide">
                                <img src="/images/angle_gauche_interieur_mosquee.jpg" alt="Angle gauche intérieur de la mosquée">
                            </div>
                            <div class="carousel-slide">
                                <img src="/images/exterieur_mosquee.jpg" alt="Extérieur de la mosquée">
                            </div>
                            <button class="carousel-prev">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button class="carousel-next">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Contact Cards -->
                    <div class="contact-info-grid">
                        <div class="quick-contact-item compact">
                            <i class="fas fa-map-marker-alt"></i>
                            <h4>Adresse</h4>
                            <p>123 Rue de la Mosquée<br>69400 Villefranche</p>
                        </div>
                        <div class="quick-contact-item compact">
                            <i class="fas fa-phone"></i>
                            <h4>Téléphone</h4>
                            <p><a href="tel:+33474680000">04 74 68 00 00</a></p>
                        </div>
                        <div class="quick-contact-item compact">
                            <i class="fas fa-envelope"></i>
                            <h4>Email</h4>
                            <p><a href="mailto:contact@mosquee-bleue.fr">contact@mosquee-bleue.fr</a></p>
                        </div>
                        <div class="quick-contact-item compact">
                            <i class="fas fa-clock"></i>
                            <h4>Horaires</h4>
                            <p>Ouvert tous les jours</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Colonne Pôles -->
            <div class="column">
                <h2 class="page-section-title">Nos Pôles d'activités</h2>
                <div class="poles-list">
                    <div class="pole-card compact">
                        <div class="pole-icon">
                            <i class="fas fa-mosque"></i>
                        </div>
                        <div class="pole-content">
                            <h3>Pôle Principal (AT)</h3>
                            <p>Gestion des prières quotidiennes et activités religieuses principales.</p>
                            <a href="/poles/at" class="btn-link">
                                En savoir plus
                                <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                    
                    <div class="pole-card compact">
                        <div class="pole-icon">
                            <i class="fas fa-book-quran"></i>
                        </div>
                        <div class="pole-content">
                            <h3>Pôle KT</h3>
                            <p>Enseignement du Coran et de la langue arabe pour tous les niveaux.</p>
                            <a href="/poles/kt" class="btn-link">
                                En savoir plus
                                <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                    
                    <div class="pole-card compact">
                        <div class="pole-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="pole-content">
                            <h3>Pôle Jeunesse</h3>
                            <p>Activités dédiées aux jeunes : sport, culture et spiritualité.</p>
                            <a href="/poles/gt" class="btn-link">
                                En savoir plus
                                <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                    
                    <div class="pole-card compact">
                        <div class="pole-icon">
                            <i class="fas fa-hands-helping"></i>
                        </div>
                        <div class="pole-content">
                            <h3>Pôle KGT</h3>
                            <p>Actions culturelles, événements communautaires et solidarité.</p>
                            <a href="/poles/kgt" class="btn-link">
                                En savoir plus
                                <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="section-cta">
                    <a href="/poles" class="btn btn-primary">
                        Découvrir nos pôles
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Section Présentation & Pôles côte à côte -->
<section class="events-news-section section compact">
    <div class="container-wide">
        <div class="two-column-layout">
            <!-- Colonne Événements -->
            <div class="column">
                <div class="section-header">
                    <h2><%= t.events.title %></h2>
                    <p><%= t.events.subtitle %></p>
                </div>
                
                <div class="events-list">
                    <% events.slice(0, 3).forEach(event => { 
                        const eventDate = new Date(event.date);
                        const day = eventDate.getDate();
                        const month = eventDate.toLocaleDateString(currentLang === 'tr' ? 'tr-TR' : 'fr-FR', { month: 'short' });
                        const eventImage = event.images && event.images.length > 0 ? event.images[0] : '/images/Logo_CIMG_VF_GT_MOSAIQUE.png';
                    %>
                    <article class="home-card">
                        <div class="home-card-image">
                            <img src="<%= eventImage %>" alt="<%= event.title %>">
                            <div class="home-card-category">Événement</div>
                        </div>
                        <div class="home-card-content">
                            <h3><%= event.title %></h3>
                            <p class="home-card-excerpt"><%= event.description ? event.description.substring(0, 100) : '' %>...</p>
                            <div class="home-card-meta">
                                <span><i class="far fa-calendar"></i> <%= day %> <%= month %></span>
                                <span><i class="far fa-clock"></i> <%= event.start_time %></span>
                                <span><i class="fas fa-map-marker-alt"></i> <%= event.location %></span>
                            </div>
                            <button class="btn btn-primary btn-sm" data-event-id="<%= event.id %>">Voir détails</button>
                        </div>
                    </article>
                    <% }); %>
                </div>
                
                <div class="section-cta">
                    <a href="/evenements" class="btn btn-primary"><%= t.events.viewAll %></a>
                </div>
            </div>

            <!-- Colonne Actualités -->
            <div class="column">
                <div class="section-header">
                    <h2>Actualités</h2>
                    <p>Nos dernières nouvelles</p>
                </div>
                
                <div class="actualites-list">
                    <% actualites.slice(0, 3).forEach((actu, index) => { 
                        const newsImage = actu.images && actu.images.length > 0 ? actu.images[0] : (actu.image || '/images/Logo_CIMG_VF_GT_MOSAIQUE.png');
                        const newsDate = new Date(actu.createdAt);
                        const day = newsDate.getDate();
                        const month = newsDate.toLocaleDateString(currentLang === 'tr' ? 'tr-TR' : 'fr-FR', { month: 'short' });
                    %>
                        <article class="home-card">
                            <div class="home-card-image">
                                <img src="<%= newsImage %>" alt="<%= actu.title %>">
                                <div class="home-card-category"><%= actu.category %></div>
                            </div>
                            <div class="home-card-content">
                                <h3><%= actu.title %></h3>
                                <p class="home-card-excerpt"><%= actu.content ? actu.content.substring(0, 100) : '' %>...</p>
                                <div class="home-card-meta">
                                    <span><i class="far fa-calendar"></i> <%= day %> <%= month %></span>
                                </div>
                                <button class="btn btn-primary btn-sm" data-news-id="<%= actu.id %>">Lire la suite</button>
                            </div>
                        </article>
                    <% }); %>
                </div>
                
                <div class="section-cta">
                    <a href="/evenements#actualites" class="btn btn-primary">Toutes les actualités</a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Section Campagnes & Dons (Compacte) -->
<% if (donations && donations.length > 0) { %>
<section class="donation-campaigns-compact">
    <div class="container">
        <h2>Soutenez nos campagnes</h2>
        
        <div class="donation-campaigns-grid">
            <% donations.slice(0, 3).forEach(donation => { 
                const percentage = Math.round((donation.current_amount / donation.goal_amount) * 100);
                let images = [];
                if (donation.images) {
                    images = typeof donation.images === 'string' ? JSON.parse(donation.images) : donation.images;
                }
                const mainImage = images.length > 0 ? images[0] : '/images/Logo_CIMG_VF_GT_MOSAIQUE.png';
            %>
                <div class="donation-campaign-card">
                    <div class="donation-campaign-image">
                        <img src="<%= mainImage %>" alt="<%= donation.title %>">
                        <div class="donation-campaign-badge">
                            <i class="fas fa-heart"></i> <%= percentage %>%
                        </div>
                    </div>
                    <div class="donation-campaign-content">
                        <h3><%= donation.title %></h3>
                        <p><%= donation.description.substring(0, 80) %>...</p>
                        
                        <div class="progress-container">
                            <div class="progress-fill" style="width: <%= percentage %>%"></div>
                        </div>
                        
                        <div class="donation-stats">
                            <span class="amount-collected"><strong><%= donation.current_amount.toLocaleString('fr-FR') %>€</strong> collectés</span>
                            <span class="amount-goal">sur <strong><%= donation.goal_amount.toLocaleString('fr-FR') %>€</strong></span>
                        </div>
                    </div>
                </div>
            <% }); %>
        </div>
        
        <div class="section-cta">
            <a href="/don" class="btn btn-primary btn-lg">
                <i class="fas fa-hand-holding-heart"></i>
                Faire un don
            </a>
        </div>
    </div>
</section>
<% } %>

<%- include('partials/footer.ejs') %>
<%- include('partials/foot.ejs') %>

